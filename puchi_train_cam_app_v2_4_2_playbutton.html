<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>puchi_train_cam_app v2.4.2</title>
<style>
html,body{margin:0;background:#fff;color:#000;font-family:system-ui,-apple-system,Segoe UI,Roboto}
.wrap{max-width:1200px;margin:0 auto;padding:10px}
.controls{display:flex;gap:8px;margin-bottom:8px}
canvas{background:#fff;border:1px solid #ccc}
.row{display:flex;gap:8px;flex-wrap:wrap}
</style>
</head>
<body>
<div class="wrap">
  <div class="controls">
    <button id="play">▶ 再生</button>
    <button id="pause">⏸ 停止</button>
    <button id="recalc">再計算</button>
  </div>
  <div class="row">
    <canvas id="anim" width="600" height="600"></canvas>
    <canvas id="camA" width="300" height="300"></canvas>
    <canvas id="camB" width="300" height="300"></canvas>
    <canvas id="camZ" width="300" height="300"></canvas>
  </div>
</div>
<script>
const TAU=Math.PI*2;
const anim=document.getElementById('anim');
const ctx=anim.getContext('2d');
const cams=[camA,camB,camZ].map(c=>c.getContext('2d'));

let t=0, playing=false, raf=null;

function drawAnim(){
  ctx.clearRect(0,0,anim.width,anim.height);
  ctx.strokeStyle='#000';
  ctx.strokeRect(50,50,500,500);
  const x=300+200*Math.cos(TAU*t);
  const y=300+200*Math.sin(TAU*t);
  ctx.beginPath();
  ctx.arc(x,y,5,0,TAU);
  ctx.fill();
}

function drawCam(ctx){
  ctx.clearRect(0,0,300,300);
  ctx.strokeStyle='#000';
  ctx.beginPath();
  ctx.arc(150,150,120,0,TAU);
  ctx.stroke();
  ctx.beginPath();
  ctx.moveTo(150,150);
  ctx.lineTo(150+120*Math.cos(TAU*t),150+120*Math.sin(TAU*t));
  ctx.stroke();
}

function renderAll(){
  drawAnim();
  cams.forEach(drawCam);
}

function loop(){
  if(!playing) return;
  t=(t+0.001)%1;
  renderAll();
  raf=requestAnimationFrame(loop);
}

document.getElementById('play').onclick=()=>{
  if(!playing){ playing=true; loop(); }
};
document.getElementById('pause').onclick=()=>{
  playing=false;
  if(raf) cancelAnimationFrame(raf);
};
document.getElementById('recalc').onclick=()=>{
  t=0;
  playing=false;
  renderAll();
};

renderAll();
</script>
</body>
</html>